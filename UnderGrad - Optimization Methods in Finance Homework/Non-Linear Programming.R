#question 1
{
library(quadprog)
machines = function(l){
  #solve for k - (100000 - 12*L) /15 = K
  k = (100000-12*l)/15
  out = .05*(l^(2/3)*k^(1/3))
  return (-out)
}
sol = optim(1,machines,method = 'CG')


#top solution = 8.66602
#top_value = 27.7864 Labor 6644.4375 Capital

}

#question 2 - import return matrix from excel
{
returnMat = c(-0.101,	0.055,	0.075,	-0.009,	-0.055,	0.061,	-0.043,	0.029,	0.107,	-0.003,	0.086,	0.209,	0.036,	0.071,	-0.019,	0.034,	0.069,	-0.03,	0.037,	-0.07,	0.021,	0.03,	0.01,	0.017,	-0.011,	0.008,	0.015,
              0.101,	0.06,	0.031,	0.043,	-0.03,	-0.099,	0.035,	0.105,	0.005,	0.021,	-0.027,	-0.114,	-0.045,	-0.026,	0.053,	0.013,	0.055,	0.015,	0.099,	-0.009,	0.035,	0.01,	-0.04,	0.014,	-0.058,	-0.032,	0.106,
              -0.074,	0.13,	-0.028,	-0.053,	0.044,	0.018,	-0.064,	-0.058,	-0.083,	0.095,	-0.061,	0.014,	0.009,	-0.048,	-0.045,	-0.059,	0.023,	0.012,	0.01,	0.049,	-0.043,	-0.074,	-0.06,	0.023,	0.022,	-0.063,	0.004,
              -0.114,	-0.047,	-0.056,	0.039,	-0.012,	-0.113,	0.017,	-0.078,	-0.015,	-0.043,	-0.019,	0.02,	-0.137,	-0.04,	-0.046,	0.065,	-0.096,	0.005,	-0.047,	0.056,	0.017,	0.064,	0.048,	0.014,	0.028,	-0.001,	-0.045,
              0.023,	0.088,	0.036,	0.078,	-0.031,	0.07,	0.014,	0.019,	0.025,	0.023,	0.039,	-0.001,	0.078,	0.007,	0.046,	0.036,	-0.02,	0.015,	-0.03,	-0.018,	-0.133,	0.006,	0.004,	0.019,	-0.048,	-0.015,	-0.02,
              0.056,	0.16,	0.015,	0.115,	0.054,	0.059,	0.028,	0.086,	0.031,	0.111,	0.047,	0.045,	-0.003,	-0.005,	0.066,	0,	0.052,	-0.012,	-0.015,	0.064,	0.058,	0.012,	0.089,	0.01,	0.023,	0.081,	-0.058,
              -0.03,	-0.006,	-0.022,	-0.006,	-0.07,	-0.117,	-0.035,	-0.094,	-0.018,	0.002,	0.026,	0.205,	-0.045,	-0.012,	-0.033,	-0.008,	-0.029,	-0.131,	0.057,	-0.085,	-0.049,	-0.045,	-0.003,	-0.038,	0.059,	0.022,	0.01,
              0.016,	0.067,	-0.005,	0.033,	-0.011,	-0.103,	-0.006,	-0.027,	0.117,	0.001,	-0.014,	0.003,	-0.112,	-0.025,	-0.069,	0.056,	0.06,	0.019,	-0.017,	0.005,	0.028,	-0.008,	-0.039,	0.073,	0.018,	0.008,	-0.004,
              0.038,	0.123,	0.029,	-0.011,	0.106,	-0.035,	0.013,	0.004,	0.089,	0.046,	0.03,	-0.022,	0.053,	0.012,	0.01,	-0.03,	0.004,	-0.099,	0.037,	-0.029,	-0.024,	-0.26,	0.013,	-0.033,	0.006,	-0.006,	0.01,
              -0.033,	0.352,	0.034,	-0.033,	0.006,	0.061,	0.002,	0.118,	-0.053,	0.063,	0.016,	-0.061,	-0.005,	0.047,	-0.047,	0.036,	-0.02,	0.015,	0.04,	-0.03,	0.03,	-0.051,	0.011,	-0.05,	-0.015,	-0.006,	0.013,
              0.05,	0.28,	0.05,	0.078,	0.137,	-0.024,	0.065,	0.066,	0.08,	0.043,	0.036,	0.252,	0.072,	0.052,	0.085,	0.038,	-0.025,	-0.027,	0.074,	0.03,	0.187,	-0.105,	0.068,	0.045,	-0.003,	0.055,	-0.035,
              -0.076,	-0.04,	0.012,	-0.034,	0.065,	0.03,	0.082,	0.044,	-0.014,	0.037,	0.038,	0.162,	0.053,	0.046,	0.012,	0.051,	0.036,	0.059,	0.043,	0.031,	0.076,	0.163,	-0.004,	0.03,	0.024,	0.059,	0.017,
              -0.061,	0.194,	-0.052,	-0.022,	-0.082,	-0.066,	-0.03,	0.03,	0.026,	-0.029,	-0.01,	0.053,	-0.066,	-0.052,	-0.068,	0.02,	-0.035,	-0.003,	0.01,	0.028,	0.045,	-0.127,	-0.016,	-0.029,	-0.066,	-0.026,	-0.008,
              0.094,	0.167,	0.015,	0.091,	0.067,	-0.034,	0.128,	-0.024,	0.027,	0.022,	-0.02,	-0.063,	0.062,	-0.007,	-0.039,	0.018,	-0.021,	0.031,	0.022,	0,	0.028,	0.13,	-0.04,	-0.003,	0.012,	-0.004,	-0.015,
              -0.054,	-0.071,	-0.049,	0.063,	-0.038,	0.027,	-0.039,	0.028,	-0.043,	-0.038,	0.024,	-0.077,	0.059,	-0.013,	-0.015,	0.024,	-0.054,	-0.02,	-0.059,	0.021,	0.007,	0.033,	-0.039,	-0.002,	-0.015,	0.018,	-0.026,
              -0.045,	-0.135,	0.026,	0.018,	-0.033,	-0.035,	-0.081,	-0.081,	-0.232,	-0.096,	0.004,	-0.111,	-0.067,	-0.164,	-0.068,	0.022,	0.036,	0.042,	-0.059,	-0.108,	-0.006,	0.047,	0.047,	0.027,	0.019,	0,	-0.059,
              -0.061,	0.103,	0.022,	0.078,	0.069,	0.123,	-0.005,	0.039,	0.061,	0.053,	0.008,	0.212,	0.1,	-0.008,	-0.053,	-0.017,	0.007,	0.027,	0.056,	0.008,	0.034,	-0.043,	0.023,	0.018,	-0.018,	0.053,	0.005,
              -0.036,	-0.074,	-0.01,	0.033,	0.013,	-0.016,	-0.075,	-0.083,	0.022,	-0.093,	-0.044,	0.035,	0.048,	-0.018,	-0.062,	-0.031,	-0.012,	-0.058,	-0.103,	-0.057,	-0.027,	-0.039,	-0.037,	-0.043,	0.016,	-0.037,	0.021,
              0.073,	0.159,	0.033,	0,	0.137,	0.004,	-0.008,	0.018,	-0.004,	0.038,	-0.004,	0.168,	0.047,	0.125,	0.046,	-0.016,	0.005,	0.048,	0.123,	0.037,	0.035,	0.008,	0.031,	0.06,	0.044,	-0.013,	0.024,
              -0.04,	0.099,	0.005,	0.019,	0.029,	-0.08,	-0.065,	-0.018,	-0.088,	-0.031,	-0.026,	-0.035,	0.128,	-0.032,	-0.016,	-0.004,	-0.036,	0.006,	0.041,	-0.046,	0.056,	-0.079,	0.072,	-0.003,	-0.015,	-0.01,	-0.086,
              -0.088,	0.143,	0.04,	0.014,	0.059,	0.017,	-0.01,	-0.042,	-0.002,	0.071,	0.008,	-0.072,	0.055,	-0.005,	-0.034,	-0.002,	0.001,	-0.012,	0.032,	0.031,	0.054,	-0.036,	-0.06,	0.072,	-0.004,	0.037,	-0.025,
              -0.005,	0.074,	-0.008,	-0.049,	-0.101,	-0.026,	0.064,	0.01,	-0.089,	0.055,	0.007,	0.003,	-0.04,	0.021,	-0.021,	-0.01,	0.09,	-0.009,	-0.057,	0.036,	0.018,	0.037,	-0.001,	-0.053,	0.009,	-0.011,	0.08,
              0.135,	0.178,	0.033,	0.059,	0.099,	0.005,	0.035,	0.023,	0.095,	0.062,	0.053,	0.095,	0.058,	0.088,	0.09,	-0.009,	0.045,	0.004,	0.093,	0.038,	-0.03,	0.055,	0.08,	0.021,	0.044,	0.054,	0.027,
              0.079,	0.06,	0.001,	0.03,	0,	-0.024,	-0.006,	-0.028,	-0.024,	0.06,	-0.012,	0.015,	-0.032,	-0.075,	0.066,	-0.027,	0.038,	-0.056,	-0.004,	-0.013,	0.037,	0.082,	-0.055,	0.012,	-0.017,	0.038,	-0.033,
              0.065,	0.05,	0.022,	-0.027,	0.18,	0.085,	-0.079,	0.056,	0.073,	-0.022,	-0.066,	-0.1,	0.089,	-0.011,	-0.029,	-0.042,	0.01,	0.027,	0.038,	-0.061,	-0.032,	0.085,	0.076,	0.028,	0.074,	0.044,	-0.015,
              -0.065,	-0.093,	0.027,	0.069,	0.076,	0.09,	0.037,	0.106,	0.118,	0.06,	0.011,	-0.084,	0.052,	-0.011,	0.012,	0.007,	0.035,	0.014,	-0.003,	0.018,	-0.005,	0.01,	-0.042,	0.012,	0.063,	0.006,	-0.016,
              0.042,	-0.084,	-0.025,	0.072,	-0.017,	0.071,	0.049,	-0.004,	0.014,	0.054,	0.058,	0.01,	0.005,	0.028,	0.055,	0.027,	0.012,	0.005,	-0.016,	0.028,	-0.004,	0.022,	0.012,	-0.038,	-0.02,	-0.009,	0.045,
              0.105,	0.122,	0.026,	0.071,	0.058,	-0.033,	0.045,	0.003,	-0.052,	0.019,	-0.006,	-0.033,	-0.013,	-0.002,	0.052,	-0.01,	0.099,	0.002,	0.006,	0.129,	0.033,	-0.023,	-0.113,	0.016,	-0.019,	0.083,	-0.047,
              -0.057,	-0.151,	0.01,	0.001,	-0.037,	-0.061,	-0.028,	0.091,	-0.097,	-0.051,	-0.009,	-0.091,	-0.003,	-0.026,	-0.058,	0.034,	-0.06,	0.049,	-0.041,	-0.015,	-0.011,	-0.022,	-0.058,	-0.068,	-0.006,	-0.001,	0.08,
              0.02,	-0.042,	-0.021,	-0.016,	0.021,	-0.008,	-0.022,	-0.016,	-0.014,	0.07,	-0.031,	-0.127,	-0.019,	-0.039,	-0.049,	-0.005,	-0.015,	-0.016,	0.013,	-0.035,	0.027,	0.094,	0.029,	0.025,	0.07,	0.014,	-0.006,
              -0.074,	0.187,	-0.019,	-0.055,	-0.044,	-0.084,	-0.046,	-0.01,	-0.064,	-0.104,	-0.008,	-0.009,	0.007,	0.008,	0.063,	0.044,	0.095,	0.035,	0.053,	-0.128,	0.089,	0.105,	0.033,	0.017,	0.088,	-0.019,	-0.076,
              -0.041,	-0.002,	0.009,	-0.029,	-0.064,	0.23,	0.017,	-0.001,	-0.044,	-0.035,	0.042,	0.236,	0.146,	0.05,	0.02,	0.04,	0.001,	0.007,	0.014,	0.025,	0.044,	0.016,	0.072,	0.101,	0.038,	0.013,	0.009,
              -0.019,	0.135,	0.067,	0.053,	-0.008,	0.045,	0.072,	0.043,	0.053,	0.077,	0.044,	0.066,	0.006,	0.012,	-0.004,	0.004,	0.029,	0.004,	0.089,	0.038,	-0.074,	0.033,	0.064,	0.001,	0.046,	0.01,	0.103,
              0.031,	0.053,	0.034,	0.013,	-0.073,	0.05,	0.069,	0.018,	0.101,	0.054,	-0.006,	0.057,	0.056,	0.127,	-0.037,	0.038,	0.017,	0.046,	0.072,	0.059,	0.063,	0.084,	0.05,	0.028,	0.063,	0.037,	-0.001,
              0.084,	0.13,	0.016,	0.112,	0.022,	0.115,	0.033,	0.051,	0.066,	0.008,	0.005,	0.099,	0.019,	-0.001,	0,	-0.017,	-0.024,	0.009,	0.026,	0.039,	0.035,	-0.02,	0.026,	-0.009,	-0.01,	-0.014,	-0.065,
              -0.036,	-0.074,	0.033,	0.004,	-0.011,	0.016,	0.038,	0.046,	-0.009,	-0.058,	0.062,	0.246,	0.046,	0.057,	0.03,	0.002,	0.044,	0.03,	0.056,	-0.043,	0.029,	-0.012,	0.017,	0.024,	0.054,	-0.031,	0.005,
              0.082,	0.01,	-0.038,	0.008,	0.05,	-0.026,	0.017,	0.026,	0.002,	0.016,	-0.031,	0.176,	0.051,	0.021,	-0.012,	0.012,	0.062,	-0.008,	0.001,	-0.047,	0.019,	0.026,	0.033,	0.014,	0.064,	0.088,	0.033,
              0.034,	-0.013,	-0.023,	-0.022,	0.006,	-0.026,	0.031,	-0.026,	-0.077,	0.035,	-0.024,	-0.003,	-0.091,	-0.06,	0.075,	-0.052,	-0.03,	-0.025,	-0.015,	0.003,	-0.036,	-0.013,	-0.084,	-0.021,	-0.022,	-0.031,	0.013,
              0.015,	0.098,	-0.008,	0.019,	0.04,	-0.016,	-0.026,	0.005,	-0.055,	-0.059,	0.013,	0.267,	0.022,	0.014,	0.011,	-0.042,	-0.02,	0.036,	0.031,	0.032,	0.052,	0.009,	-0.011,	-0.005,	0.071,	-0.01,	-0.024,
              0.047,	0.074,	0.079,	0.046,	0.088,	0.047,	-0.005,	0.016,	0.104,	-0.018,	0.042,	0.066,	0.05,	0.084,	0.036,	0.066,	0.085,	0.087,	0.072,	0.083,	0.046,	0.165,	0.074,	0.025,	-0.009,	0.033,	0.021,
              0.169,	0.214,	0.071,	0.086,	0.082,	0.007,	0.072,	0.013,	0.028,	0.059,	0.02,	0.066,	0.085,	0.047,	0.045,	-0.008,	-0.005,	0.015,	0.047,	0.069,	0.032,	0.02,	0.028,	-0.013,	0.067,	0.055,	-0.002,
              -0.018,	0.007,	-0.058,	-0.044,	-0.004,	0.035,	-0.028,	-0.037,	0.097,	-0.005,	0.026,	-0.02,	-0.022,	-0.013,	-0.003,	-0.026,	-0.065,	-0.006,	0.004,	-0.013,	-0.003,	-0.043,	-0.04,	-0.037,	0.004,	0.005,	0.011,
              -0.058,	0.08,	-0.041,	0.076,	0.011,	0.038,	-0.081,	-0.033,	-0.093,	-0.002,	0.012,	-0.174,	0.032,	0.051,	-0.051,	-0.018,	-0.084,	-0.004,	-0.057,	0.024,	-0.053,	-0.003,	-0.017,	0.017,	-0.048,	0.029,	-0.045,
              -0.039,	0.051,	0.001,	-0.062,	-0.038,	0.104,	0.051,	0.018,	0.056,	-0.01,	0.003,	-0.037,	0.072,	0.058,	-0.046,	0.028,	0.012,	0.032,	0.029,	0.029,	0.044,	0.01,	-0.005,	0.056,	0.018,	0.027,	-0.046,
              0.071,	0.108,	0.013,	0.086,	0.035,	0.038,	0.017,	0.023,	0.004,	-0.044,	0.072,	0.099,	0.011,	0.01,	0.022,	0.063,	0.029,	0.075,	0.106,	0.028,	0.013,	0.038,	0.025,	0.077,	0.061,	0.078,	0,
              0.016,	0.238,	0.029,	-0.061,	-0.044,	-0.002,	-0.001,	0.007,	0.08,	-0.013,	-0.006,	-0.009,	0.038,	-0.014,	0.03,	-0.008,	0.034,	0.075,	0.097,	-0.077,	0.049,	0.127,	0.25,	-0.007,	-0.004,	-0.048,	0.036,
              -0.081,	-0.041,	-0.032,	-0.058,	-0.036,	-0.152,	-0.06,	-0.043,	-0.181,	-0.047,	-0.07,	-0.046,	-0.01,	-0.091,	-0.08,	0.046,	-0.029,	0.011,	0.004,	-0.03,	0.063,	0.019,	-0.084,	0.064,	-0.086,	-0.02,	0.06,
              0.005,	0.087,	-0.118,	-0.055,	0.009,	-0.034,	-0.045,	-0.016,	-0.069,	-0.094,	-0.023,	-0.018,	-0.012,	0.028,	-0.041,	-0.015,	-0.043,	-0.012,	0.008,	0.013,	-0.016,	-0.015,	0.059,	-0.008,	0.088,	0.024,	-0.003,
              -0.095,	-0.317,	-0.052,	-0.049,	-0.016,	-0.095,	0.025,	-0.076,	-0.089,	0.047,	-0.046,	-0.107,	-0.134,	-0.009,	-0.006,	-0.053,	0.095,	-0.039,	-0.09,	-0.055,	0.003,	-0.207,	-0.084,	-0.104,	-0.065,	-0.043,	0.067,
              0.128,	-0.076,	-0.139,	0,	0.019,	-0.004,	0.036,	0.086,	-0.148,	-0.056,	-0.054,	0.075,	0.093,	0.067,	-0.008,	-0.012,	-0.142,	-0.009,	0.017,	-0.009,	-0.035,	-0.039,	-0.162,	0.012,	-0.095,	-0.033,	-0.023,
              -0.029,	0.148,	0.033,	-0.102,	0.082,	-0.012,	0.007,	-0.032,	0.04,	0.053,	0.117,	-0.048,	-0.043,	0.011,	-0.142,	0.047,	0.056,	0.048,	0.031,	0.01,	-0.005,	-0.136,	0.043,	0.059,	0.1,	-0.024,	0.067,
              -0.031,	0.212,	0.103,	0.141,	0.051,	0.064,	0.046,	0.034,	0.013,	0.035,	-0.116,	0.038,	0.015,	0.048,	-0.038,	0.034,	0.118,	-0.033,	0.068,	-0.028,	-0.099,	0.002,	0.005,	-0.038,	0.021,	0.053,	0.101,
              0.167,	0.085,	-0.035,	-0.02,	0.009,	0.042,	-0.012,	0.036,	-0.13,	-0.043,	-0.061,	-0.051,	0.015,	0.077,	0.049,	0.002,	-0.098,	-0.027,	-0.004,	0.015,	0.113,	0.024,	-0.003,	-0.015,	0.031,	-0.015,	0,
              -0.123,	-0.113,	-0.187,	-0.206,	-0.107,	-0.129,	-0.105,	-0.071,	-0.058,	-0.14,	-0.122,	-0.298,	-0.059,	-0.084,	-0.144,	-0.036,	-0.202,	-0.086,	-0.046,	-0.103,	-0.064,	-0.023,	-0.029,	-0.079,	-0.155,	-0.131,	-0.027,
              -0.052,	-0.051,	-0.01,	-0.07,	-0.053,	-0.055,	0.021,	-0.027,	0.015,	0.001,	0.06,	0.101,	0.013,	0.08,	0.19,	0.064,	0.198,	-0.009,	0.063,	0.011,	-0.01,	-0.127,	-0.065,	0.084,	-0.074,	0.037,	0.043,
              -0.043,	0.067,	0.069,	0.079,	0.017,	0.094,	0.024,	0.066,	0.106,	0.05,	-0.007,	-0.001,	0.047,	-0.045,	-0.016,	0.035,	-0.053,	0.011,	0.043,	0.024,	0.034,	0.084,	0.065,	0.065,	0.038,	0.03,	0.012,
              -0.297,	-0.33,	-0.107,	-0.125,	-0.157,	-0.062,	-0.093,	-0.051,	-0.051,	-0.044,	-0.081,	-0.219,	-0.013,	-0.039,	-0.032,	-0.016,	0.213,	0.023,	-0.005,	-0.046,	-0.042,	-0.105,	-0.022,	-0.001,	-0.127,	-0.084,	0.014,
              -0.491,	-0.053,	-0.22,	-0.086,	-0.353,	-0.212,	-0.205,	-0.156,	-0.391,	-0.173,	-0.235,	-0.417,	-0.172,	-0.205,	-0.341,	-0.115,	-0.11,	-0.167,	-0.061,	-0.059,	-0.033,	-0.019,	-0.164,	-0.068,	-0.026,	-0.085,	-0.068,
              -0.052,	-0.139,	-0.152,	-0.181,	0.073,	-0.069,	-0.207,	-0.131,	-0.174,	0.081,	-0.12,	-0.279,	-0.078,	-0.117,	-0.263,	-0.037,	-0.233,	0.073,	0.023,	0.049,	-0.162,	-0.137,	-0.088,	-0.003,	0.067,	-0.11,	0.001,
              0.047,	-0.079,	-0.204,	0.001,	0.09,	-0.015,	0.01,	0.023,	-0.131,	-0.09,	-0.039,	-0.072,	0.031,	0.031,	-0.052,	0.021,	-0.004,	-0.034,	0.059,	-0.14,	-0.044,	0.154,	-0.039,	-0.039,	-0.002,	0.104,	0.007,
              -0.309,	0.056,	-0.09,	-0.008,	-0.302,	-0.082,	-0.092,	-0.089,	-0.312,	-0.206,	-0.251,	0.034,	-0.042,	0.089,	-0.227,	-0.036,	-0.181,	-0.056,	-0.067,	-0.065,	0.098,	-0.061,	-0.12,	-0.112,	-0.123,	-0.105,	-0.159,
              -0.183,	-0.009,	-0.279,	-0.249,	-0.202,	-0.027,	-0.169,	-0.189,	-0.296,	-0.152,	-0.278,	-0.28,	-0.165,	0.01,	-0.355,	-0.126,	-0.104,	-0.044,	-0.091,	-0.146,	-0.067,	-0.152,	-0.05,	-0.116,	-0.034,	-0.142,	0.045,
              0.179,	0.177,	0.13,	0.132,	0.136,	0.151,	0.191,	0.083,	0.191,	0.033,	0.188,	0.41,	0.108,	0.053,	0.238,	0.052,	0.163,	0.087,	0.044,	0.094,	0.058,	0.124,	0.138,	-0.022,	0.06,	0.053,	0.064,
              0.236,	0.197,	0.876,	0.126,	0.289,	0.152,	0.249,	0.206,	-0.197,	0.258,	0.252,	0.756,	0.122,	0.065,	0.798,	-0.005,	0.244,	-0.02,	-0.023,	0.158,	0.02,	-0.093,	0.103,	0.059,	0.033,	0.136,	-0.033,
              0.019,	0.079,	-0.015,	0.131,	-0.004,	-0.042,	0.035,	0.106,	-0.144,	-0.009,	0.065,	0.042,	-0.045,	0.035,	0.137,	0.063,	0.118,	0.142,	0.107,	0,	0.046,	0.138,	0.037,	0.051,	-0.033,	0.085,	-0.008,
              0.12,	0.049,	-0.058,	-0.052,	-0.068,	0.008,	-0.1,	-0.037,	0.134,	0.005,	-0.123,	-0.017,	0.128,	-0.018,	0.053,	0.03,	-0.076,	-0.015,	-0.017,	0.053,	-0.022,	0.028,	0.138,	-0.016,	0.002,	-0.012,	-0.026,
              0.139,	0.147,	0.219,	0.009,	0.35,	0.18,	0.208,	0.077,	0.003,	0.22,	0.143,	0.512,	0.12,	0.129,	0.243,	0.072,	0.135,	0.039,	-0.042,	0.173,	0.069,	0.073,	-0.011,	0.095,	0.074,	0.048,	0.03,
              0.027,	0.029,	0.194,	0.169,	0.028,	-0.019,	0.045,	0.037,	0.791,	0.013,	0.037,	-0.031,	0.037,	0.006,	0.222,	0.001,	0.125,	-0.022,	0.03,	0.03,	0.043,	0.081,	0.054,	-0.025,	-0.007,	0.097,	0.025,
              0.089,	0.102,	0.008,	0.09,	0.133,	0.09,	0.007,	0.055,	-0.102,	0.096,	0.188,	0.033,	0.053,	0.013,	-0.032,	0.007,	0.008,	0.11,	0.015,	0.024,	-0.008,	-0.013,	0.043,	0.07,	0.037,	0.027,	-0.035,
              -0.054,	0.017,	0.027,	-0.117,	0.08,	-0.031,	-0.01,	-0.003,	-0.215,	-0.034,	-0.132,	-0.244,	0.005,	0.008,	0.004,	-0.03,	-0.046,	-0.007,	0.027,	-0.003,	0.017,	-0.022,	0.078,	0.009,	-0.035,	0.009,	0.012,
              0.011,	0.061,	0.201,	0.106,	0.06,	0.026,	0.1,	0.104,	0.08,	0.162,	0.124,	0.064,	0.034,	0.052,	0.142,	0.073,	0.017,	0.081,	0.088,	0.059,	0.038,	0.171,	0.065,	0.075,	0.049,	0.1,	0.098,
              0.288,	0.054,	-0.031,	0.033,	-0.024,	0.023,	-0.026,	0.079,	0.042,	-0.011,	-0.05,	0.028,	0.052,	0.036,	0.053,	0.025,	-0.019,	-0.004,	-0.013,	0.068,	0.062,	0.019,	0.036,	-0.028,	0.041,	0.032,	-0.015,
              -0.211,	-0.089,	-0.067,	0.12,	-0.077,	-0.061,	-0.031,	-0.084,	0.434,	-0.061,	0.063,	-0.054,	-0.086,	-0.065,	-0.145,	-0.024,	-0.065,	-0.048,	0,	-0.026,	0.012,	0.045,	-0.075,	0.022,	-0.082,	-0.028,	0,
              0.047,	0.065,	0.014,	0.049,	0.092,	0.083,	0.047,	0.057,	-0.018,	0.082,	0.005,	-0.026,	0.079,	0.044,	0.012,	0.01,	0.078,	-0.028,	0.031,	0.002,	0.013,	-0.034,	0.022,	0.028,	-0.022,	0.024,	0.012,
              0.071,	0.148,	0.085,	0.15,	0.102,	0.07,	0.104,	0.117,	-0.025,	0.103,	0.133,	-0.027,	0.048,	0.009,	0.062,	0.035,	0.066,	0.052,	0.045,	0.043,	0.038,	0.023,	0.022,	0,	0.042,	0.072,	0.034,
              -0.057,	0.111,	0.118,	-0.002,	0.09,	0.035,	0.07,	0.055,	0.059,	-0.036,	0.036,	0.062,	-0.022,	0.006,	0.087,	-0.014,	-0.047,	-0.028,	0.058,	0.061,	0.033,	-0.062,	0.043,	-0.01,	0.025,	0.018,	-0.035,
              -0.131,	-0.016,	-0.135,	-0.109,	-0.108,	-0.14,	-0.082,	-0.093,	-0.08,	-0.072,	-0.133,	-0.114,	-0.115,	-0.024,	-0.127,	-0.085,	-0.07,	-0.038,	-0.045,	-0.1,	-0.043,	-0.039,	-0.151,	-0.017,	-0.068,	-0.096,	-0.052)

returnMat = matrix(returnMat,77,27,byrow = TRUE)

#create mean return and variance return vector
est_mean_return = c(rep(0,27))
est_var = c(rep(0,27))
for (i in 1:ncol(returnMat)){
  est_mean_return[i] = mean(returnMat[1:nrow(returnMat),i])
  est_var[i] = var(returnMat[1:nrow(returnMat),i])
}
#create covariance matrix
rho = cor(returnMat)
covar = diag(est_var) %*% rho %*% diag(est_var)
  #start inputing into the correct for solve.qp
Dmat = 2*covar
Amat = matrix(c(rep(1,27),rep(-1,27),est_mean_return,-est_mean_return),27)
Amat = cbind(Amat,diag(27))
Bmat = c(1,-1,.01,-.01,rep(0,27))
dvec = rep(0,27)
S=solve.QP(Dmat,dvec,Amat,Bmat)
#S$solution is the matrix
}
#question 3
{
  {
  mat = matrix(c(25,	31,	13,	10,2,	17,	19,	7,29,	26,	28,	0, 21,	32,	23,	17,3,	16,	38,	24,13,	22,	7,	24,20,	11,	45,	27,30,	9,	21,	34,1,	28,	16,	20,5,	24,	10,	38,12,	6,	21,	15,7,	10,	7,	12,8,18,	20,	34,14,	15,	14,	12,23,	27,	20,	24,19,	4,	25,	24,31,	13,	31,	34,16,	23,	10,	13,24,	20,	22,	48,
                 22,	19,	16,	9,
                 32,	26,	9,	7,
                 27,	3,	26,	31,
                 28,	29,	23,	10,
                 11,	18,	13,	27,
                 9,	21,	31,	33,
                 2,	5,	28,	20,
                 4,	30,	33,	20,
                 6,	25,	17,	14,
                 12,	7,	24,	31,
                 10,	8,	27,	6,
                 15,	1,	17,	31,
                 17,	14,	23,	27,
                 26,	12,	17,	36,
                 13,	15,	24,	31,
                 24,	16,	34,	14,
                 27,	17,	23,	13,
                 18,	28,	27,	24,
                 30,	21,	0,	24,
                 22,	31,	24,	17,
                 11,	32,	19,	14,
                 23,	10,	3,	23,
                 1,	14,	10,	31,
                 3,	8,	34,	3,
                 7,	25,	23,	20,
                 29,	6,	19,	25,
                 19,	2,	26,	10,
                 4,	20,	7,	27,
                 9,	5,	21,	7,
                 15,	31,	37,	17,
                 16,	21,	16,	27,
   -              20,	22,	24,	10,
                 19,	3,	27,	21,
                 25,	27,	38,	28,
                 28,	26,	35,	0,
                 32,	30,	16,	13,
                 13,	23,	29,	6,
                 10,	9,	17,	10,
                 14,	29,	34,	17,
                 8,	7,	20,	23,
                 6,	11,	48,	24,
                 17,	4,	38,	10,
                 18,	12,	30,	23,
                 28,	2,	10,	45,
                 5,	32,	20,	17,
                 24,	30,	33,	14,
                 1,	13,	28,	21,
                 29,	15,	41,	0,
                 11,	25,	20,	28,
                 10,	19,	20,	17,
                 16,	9,	20,	26,
                 31,	14,	9,	31,
                 3,	7,	14,	17,
                 21,	23,	44,	7,
                 4,	8,	3,	6,
                 26,	18,	10,	38,
                 17,	22,	31,	27,
                 20,	21,	48,	27,
                 23,	24,	13,	9,
                 29,	1,	3,	27,
                 30,	5,	21,	28,
                 2,	6,	21,	14,
                 19,	31,	59,	0,
                 18,	3,	33,	31,
                 32,	16,	6,	14,
                 15,	26,	23,	20,
                 12,	11,	26,	0,
                 25,	8,	27,	14,
                 7,	13,	17,	28,
                 22,	4,	13,	16,
                 27,	10,	23,	34,
                 26,	14,	6,	42,
                 9,	2,	37,	21,
                 17,	20,	34,	46,
                 7,	6,	45,	10,
                 21,	1,	17,	24,
                 16,	27,	7,	37,
                 8,	12,	3,	31,
                 25,	18,	27,	17,
                 30,	19,	7,	35,
                 5,	4,	9,	20,
                 23,	22,	0,	38,
                 13,	28,	24,	21,
                 32,	24,	17,	27,
                 22,	17,	25,	30,
                 31,	15,	30,	13,
                 12,	18,	26,	38,
                 11,	26,	10,	17,
                 3,	10,	30,	7,
                 9,	29,	38,	17,
                 14,	28,	18,	14,
                 6,	8,	30,	6,
                 1,	5,	21,	34,
                 24,	21,	40,	17,
                 4,	13,	10,	31,
                 27,	23,	24,	16,
                 20,	2,	35,	27,
                 28,	31,	27,	34,
                 19,	17,	27,	17,
                 15,	16,	24,	21,
                 30,	12,	38,	28,
                 29,	11,	32,	20,
                 20,	5,	30,	20,
                 24,	9,	16,	20,
                 14,	13,	20,	17,
                 7,	3,	17,	7,
                 6,	1,	21,	41,
                 2,	32,	31,	17,
                 21,	27,	20,	21,
                 10,	25,	10,	28,
                 28,	6,	10,	6,
                 22,	15,	22,	24,
                 23,	16,	10,	16,
                 17,	30,	25,	23,
                 26,	20,	23,	28,
                 27,	24,	31,	23,
                 18,	11,	27,	10,
                 32,	10,	27,	17,
                 12,	9,	17,	7,
                 5,	2,	28,	19,
                 31,	4,	41,	17,
                 25,	7,	12,	18,
                 14,	19,	35,	34,
                 1,	29,	31,	20,
                 8,	3,	0,	16,
                 5,	17,	17,	24,
                 10,	27,	3,	32,
                 12,	28,	30,	24,
                 16,	25,	27,	24,
                 18,	29,	35,	9,
                 30,	20,	7,	38,
                 19,	22,	31,	14,
                 9,	32,	7,	6,
                 26,	1,	13,	21,
                 3,	14,	15,	17,
                 11,	8,	38,	37,
                 23,	7,	20,	17,
                 6,	24,	20,	24,
                 15,	4,	18,	15,
                 21,	2,	34,	31,
                 13,	31,	17,	20,
                 11,	12,	12,	34,
                 10,	21,	26,	6,
                 9,	23,	24,	7,
                 3,	25,	20,	17,
                 24,	32,	27,	24,
                 27,	16,	43,	14,
                 28,	15,	20,	3,
                 26,	29,	17,	27,
                 4,	17,	31,	14,
                 31,	1,	20,	17,
                 2,	30,	20,	17,
                 22,	5,	17,	6,
                 18,	6,	36,	10,
                 7,	8,	16,	7,
                 13,	14,	27,	35,
                 20,	19,	38,	17,
                 4,	22,	13,	19,
                 16,	10,	13,	44,
                 15,	13,	23,	18,
                 17,	19,	22,	21,
                 32,	20,	30,	33,
                 25,	23,	24,	27,
                 29,	28,	20,	17,
                 21,	9,	31,	24,
                 1,	18,	30,	17,
                 2,	24,	7,	34,
                 5,	30,	16,	6,
                 6,	26,	17,	9,
                 7,	11,	23,	13,
                 8,	27,	23,	30,
                 14,	31,	27,	17,
                 12,	3,	27,	14,
                 8,	25,	13,	6,
                 13,	29,	34,	7,
                 15,	17,	10,	14,
                 21,	24,	38,	45,
                 30,	22,	3,	26,
                 31,	26,	47,	7,
                 23,	32,	13,	34,
                 3,	11,	48,	3,
                 9,	27,	17,	20,
                 14,	10,	28,	16,
                 18,	7,	30,	10,
                 6,	12,	14,	21,
                 19,	5,	20,	10,
                 16,	4,	10,	16,
                 2,	20,	23,	26,
                 28,	1,	24,	9,
                 15,	14,	31,	35,
                 20,	9,	17,	24,
                 24,	28,	27,	13,
                 31,	17,	27,	24,
                 26,	13,	13,	16,
                 25,	12,	37,	36,
                 10,	23,	19,	20,
                 29,	30,	7,	24,
                 11,	1,	24,	31,
                 16,	8,	34,	41,
                 27,	7,	27,	24,
                 3,	6,	31,	7,
                 5,	18,	26,	7,
                 4,	19,	10,	17,
                 22,	2,	7,	10,
                 32,	21,	12,	45,
                 31,	27,	17,	42,
                 21,	5,	9,	41,
                 20,	30,	17,	20,
                 19,	15,	35,	7,
                 17,	13,	20,	27,
                 25,	3,	23,	20,
                 28,	11,	20,	6,
                 24,	10,	30,	27,
                 32,	9,	0,	17,
                 1,	26,	31,	10,
                 14,	22,	15,	29,
                 8,	23,	23,	9,
                 2,	4,	31,	3,
                 12,	29,	48,	10,
                 7,	16,	17,	10,
                 6,	18,	36,	30,
                 25,	32,	23,	20,
                 29,	28,	6,	28,
                 23,	3,	13,	21,
                 29,	31,	13,	17,
                 18,	21,	44,	7,
                 17,	25,	24,	30,
                 13,	19,	34,	27,
                 10,	16,	24,	44,
                 9,	24,	24,	0,
                 30,	2,	10,	20,
                 4,	14,	30,	7,
                 5,	20,	23,	10,
                 11,	6,	23,	37,
                 22,	6,	37,	0,
                 8,	15,	23,	17,
                 1,	12,	7,	33,
                 25,	31,	13,	10,
                 2,	17,	19,	7,
                 29,	26,	28,	0,
                 21,	32,	23,	17,
                 3,	16,	38,	24,
                 13,	22,	7,	24,
                 20,	11,	45,	27,
                 30,	9,	21,	34,
                 1,	28,	16,	20,
                 5,	24,	10,	38,
                 12,	6,	21,	15,
                 7,	10,	7,	12,
                 8,	18,	20,	34,
                 14,	15,	14,	12,
                 23,	27,	20,	24,
                 19,	4,	25,	24,
                 31,	13,	31,	34,
                 16,	23,	10,	13,
                 24,	20,	22,	48,
                 22,	19,	16,	9,
                 32,	26,	9,	7,
                 27,	3,	26,	31,
                 28,	29,	23,	10,
                 11,	18,	13,	27,
                 9,	21,	31,	33,
                 2,	5,	28,	20,
                 4,	30,	33,	20,
                 6,	25,	17,	14,
                 12,	7,	24,	31,10,	8,	27,	6,15,	1,	17,	31,
                 17,	14,	23,	27,
                 26,	12,	17,	36,    13,	15,	24,	31,
                 24,	16,	34,	14,
                 27,	17,	23,	13,
                 18,	28,	27,	24,
                 30,	21,	0,	24,
                 22,	31,	24,	17,
                 11,	32,	19,	14,
                 23,	10,	3,	23,
                 1,	14,	10,	31,
                 3,	8,	34,	3,
                 7,	25,	23,	20,
                 29,	6,	19,	25,
                 19,	2,	26,	10,
                 4,	20,	7,	27,
                 9,	5,	21,	7,
                 15,	31,	37,	17,
                 16,	21,	16,	27,
                 20,	22,	24,	10,
                 19,	3,	27,	21,
                 25,	27,	38,	28,
                 28,	26,	35,	0,
                 32,	30,	16,	13,
                 13,	23,	29,	6,
                 10,	9,	17,	10,
                 14,	29,	34,	17,
                 8,	7,	20,	23,
                 6,	11,	48,	24,
                 17,	4,	38,	10,
                 18,	12,	30,	23,
                 28,	2,	10,	45,
                 5,	32,	20,	17,
                 24,	30,	33,	14,
                 1,	13,	28,	21,
                 29,	15,	41,	0,
                 11,	25,	20,	28,
                 10,	19,	20,	17,
                 16,	9,	20,	26,
                 31,	14,	9,	31,
                 3,	7,	14,	17,
                 21,	23,	44,	7,
                 4,	8,	3,	6,
                 26,	18,	10,	38,
                 17,	22,	31,	27,
                 20,	21,	48,	27,
                 23,	24,	13,	9,
                 29,	1,	3,	27,
                 30,	5,	21,	28,
                 2,	6,	21,	14,
                 19,	31,	59,	0,
                 18,	3,	33,	31,
                 32,	16,	6,	14,
                 15,	26,	23,	20,
                 12,	11,	26,	0,
                 25,	8,	27,	14,
                 7,	13,	17,	28,
                 22,	4,	13,	16,
                 27,	10,	23,	34,
                 26,	14,	6,	42,
                 9,	2,	37,	21,
                 17,	20,	34,	46,
                 7,	6,	45,	10,
                 21,	1,	17,	24,
                 16,	27,	7,	37,
                 8,	12,	3,	31,
                 25,	18,	27,	17,
                 30,	19,	7,	35,
                 5,	4,	9,	20,
                 23,	22,	0,	38,
                 13,	28,	24,	21,
                 32,	24,	17,	27,
                 22,	17,	25,	30,
                 31,	15,	30,	13,
                 12,	18,	26,	38,
                 11,	26,	10,	17,
                 3,	10,	30,	7,
                 9,	29,	38,	17,
                 14,	28,	18,	14,
                 6,	8,	30,	6,
                 1,	5,	21,	34,
                 24,	21,	40,	17,
                 4,	13,	10,	31,
                 27,	23,	24,	16,
                 20,	2,	35,	27,
                 28,	31,	27,	34,
                 19,	17,	27,	17,
                 15,	16,	24,	21,
                 30,	12,	38,	28,
                 29,	11,	32,	20,
                 20,	5,	30,	20,
                 24,	9,	16,	20,
                 14,	13,	20,	17,
                 7,	3,	17,	7,
                 6,	1,	21,	41,
                 2,	32,	31,	17,
                 21,	27,	20,	21,
                 10,	25,	10,	28,
                 28,	6,	10,	6,
                 22,	15,	22,	24,
                 23,	16,	10,	16,
                 17,	30,	25,	23,
                 26,	20,	23,	28,
                 27,	24,	31,	23,
                 18,	11,	27,	10,
                 32,	10,	27,	17,
                 12,	9,	17,	7,
                 5,	2,	28,	19,
                 31,	4,	41,	17,
                 25,	7,	12,	18,
                 14,	19,	35,	34,
                 1,	29,	31,	20,
                 8,	3,	0,	16,
                 5,	17,	17,	24,
                 10,	27,	3,	32,
                 12,	28,	30,	24,
                 16,	25,	27,	24,
                 18,	29,	35,	9,
                 30,	20,	7,	38,
                 19,	22,	31,	14,
                 9,	32,	7,	6,
                 26,	1,	13,	21,
                 3,	14,	15,	17,
                 11,	8,	38,	37,
                 23,	7,	20,	17,
                 6,	24,	20,	24,
                 15,	4,	18,	15,
                 21,	2,	34,	31,
                 13,	31,	17,	20,
                 11,	12,	12,	34,
                 10,	21,	26,	6,
                 9,	23,	24,	7,
                 3,	25,	20,	17,
                 24,	32,	27,	24,
                 27,	16,	43,	14,
                 28,	15,	20,	3,
                 26,	29,	17,	27,
                 4,	17,	31,	14,
                 31,	1,	20,	17,
                 2,	30,	20,	17,
                 22,	5,	17,	6,
                 18,	6,	36,	10,
                 7,	8,	16,	7,
                 13,	14,	27,	35,
                 20,	19,	38,	17,
                 4,	22,	13,	19,
                 16,	10,	13,	44,
                 15,	13,	23,	18,
                 17,	19,	22,	21,
                 32,	20,	30,	33,
                 25,	23,	24,	27,
                 29,	28,	20,	17,
                 21,	9,	31,	24,
                 1,	18,	30,	17,
                 2,	24,	7,	34,
                 5,	30,	16,	6,
                 6,	26,	17,	9,
                 7,	11,	23,	13,
                 8,	27,	23,	30,
                 14,	31,	27,	17,12,	3,	27,	14,
                 8,	25,	13,	6,
                 13,	29,	34,	7,
                 15,	17,	10,	14,
                 21,	24,	38,	45,
                 30,	22,	3,	26,
                 31,	26,	47,	7,
                 23,	32,	13,	34,
                 3,	11,	48,	3,
                 9,	27,	17,	20,
                 14,	10,	28,	16,18,	7,	30,	10,
                 6,	12,	14,	21,
                 19,	5,	20,	10,
                 16,	4,	10,	16,
                 2,	20,	23,	26,
                 28,	1,	24,	9,
                 15,	14,	31,	35,
                 20,	9,	17,	24,
                 24,	28,	27,	13,
                 31,	17,	27,	24,
                 26,	13,	13,	16,
                 25,	12,	37,	36,
                 10,	23,	19,	20,
                 29,	30,	7,	24,
                 11,	1,	24,	31,
                 16,	8,	34,	41,
                 27,	7,	27,	24,
                 3,	6,	31,	7,
                 5,	18,	26,	7,
                 4,	19,	10,	17,
                 22,	2,	7,	10,
                 32,	21,	12,	45,
                 31,	27,	17,	42,
                 21,	5,	9,	41,
                 20,	30,	17,	20,
                 19,	15,	35,	7,
                 17,	13,	20,	27,
                 25,	3,	23,	20,
                 28,	11,	20,	6,
                 24,	10,	30,	27,
                 32,	9,	0,	17,
                 1,	26,	31,	10,
                 14,	22,	15,	29,
                 8,	23,	23,	9,
                 2,	4,	31,	3,
                 12,	29,	48,	10,
                 7,	16,	17,	10,
                 6,	18,	36,	30,
                 25,	32,	23,	20,
                 29,	28,	6,	28,
                 23,	3,	13,	21, 29,	31,	13,	17,  18,	21,	44,	7,
                 17,	25,	24,	30,
                 13,	19,	34,	27,
                 10,	16,	24,	44,
                 9,	24,	24,	0,30,	2,	10,	20,4,	14,	30,	7,
                 5,	20,	23,	10,
                 11,	6,	23,	37,
                 22,	6,	37,	0,
                 8,	15,	23,	17,1,	12,	7,	33),256,4)
}
#adjusted matrix
mat_adj = matrix(0,nrow(mat),(6))
mat_adj[1:nrow(mat),1:4] = mat
#add actual point spread
  for (k in 1:nrow(mat)){
    mat_adj[k,5] = mat_adj[k,3] - mat_adj[k,4]
  }
}
regress = function(inp){
  #inp is a 33 point matrix, inp[1:32] = pick factors 
  errors = 0
  for (i in 1:nrow(mat_adj)){
    errors = errors + ((mat_adj[i,4] + - inp[(mat_adj[i,1])]+inp[(mat_adj[i,2])]-inp[33])^2)
  return (errors)
  }
}
#optiminize to find prediction
football =optim(c(rep(0,33)),regress,method = 'CG')
